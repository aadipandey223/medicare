# How to Configure Google Sign-In

## Quick Setup Guide

### 1. Get Google OAuth Credentials

1. Go to: https://console.cloud.google.com/
2. Create a new project or select existing one
3. Go to "APIs & Services" > "Credentials"
4. Click "Create Credentials" > "OAuth client ID"
5. Choose "Web application"
6. Add authorized JavaScript origins (required for the popup flow we use):
   - http://localhost:5173   (Vite dev server - default)
   - http://localhost:3000   (only if you run a dev server on 3000)
   - Your production domain (e.g., https://yourapp.com)
7. Authorized redirect URIs (optional):
   - Not required for the Google Identity Services popup/one-tap flow used here.
   - Only add redirect URIs if you explicitly switch to the redirect flow.
8. Click "Create"
9. Copy the "Client ID" (looks like: 123456789-abc123.apps.googleusercontent.com)

### 2. Update Configuration Files

**Frontend (.env.local):**
```bash
VITE_GOOGLE_CLIENT_ID=YOUR_ACTUAL_CLIENT_ID_HERE
# Point the frontend to your backend during dev
VITE_API_URL=http://localhost:5000
```

**Backend (.env):**
```bash
GOOGLE_CLIENT_ID=YOUR_ACTUAL_CLIENT_ID_HERE
JWT_SECRET=change-me
DATABASE_URL=sqlite:///medicare.db
```

### 3. Restart Both Servers

**Backend:**
```bash
py app.py
```

**Frontend:**
```bash
npm run dev
```

### 4. Test

1. Open http://localhost:5173 (Vite default)
2. You should now see the Google Sign-In button working
3. Click it to test authentication

## Notes

- Without configuration, the app will show a message: "Google Sign-In is not configured"
- Users can still login with email/password
- The app works fine without Google OAuth
- It's optional, not required

## Troubleshooting

**Error: "Google authentication failed"**
- Check if Client ID is correct
- Verify origins/redirects in Google Console
- Make sure .env.local is loaded (restart frontend)

**Button not showing:**
- Check browser console for errors
- Verify @react-oauth/google is installed: `npm install @react-oauth/google`
- Clear browser cache
 - Ensure VITE_GOOGLE_CLIENT_ID is set in `.env.local`, then restart the frontend

**Error: "Google Sign-In is not configured":**
- Backend requires GOOGLE_CLIENT_ID in `.env`
- Frontend requires VITE_GOOGLE_CLIENT_ID in `.env.local`
- After setting both, restart both servers

## Security Notes

- Never commit .env files with real credentials
- Use different Client IDs for dev/production
- Keep Service Account keys secure
- Rotate credentials regularly

## How it works (quick technical note)

- Frontend uses Google Identity Services (popup) via `@react-oauth/google` to get an ID token (JWT).
- Backend verifies the ID token with Google's public keys using `google-auth` and checks audience against `GOOGLE_CLIENT_ID`.
- If the email is verified, we create or find the user and return our own session JWT.
